
<!DOCTYPE html>
<html>
  <head>
    <title>Infrastruktur som kode</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <script src="https://github.com/downloads/gnab/remark/remark-0.3.1.min.js" type="text/javascript">
      { "highlightStyle": "solarized_light" }
    </script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
    <script src="remark-bekk/lib/bekk.js" type="text/javascript"></script>

    <link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>

    <link rel="stylesheet/less" type="text/css" href="remark-bekk/lib/bekk.less">
    <script src="http://lesscss.googlecode.com/files/less-1.1.5.min.js" type="text/javascript"></script>

    <style>
      .greyscale img {
        -webkit-filter: grayscale(1);
      }

      .source {
        bottom: 12px;
        left: 20px;
        opacity: .5;
        position: absolute;
        font-size: 0.7em;
      }

      .source::before {
        content: "Kilde: ";
      }

      table {
        border-collapse: collapse;
      }

      th {
        color: rgba(255, 255, 255, .5);
        font-weight: normal;
        text-align: left;
      }

      td,
      th {
        padding: 5px 10px;
        vertical-align: top;
      }

      td.has::after {
        content: "✓";
      }
    </style>
  </head>
  <body>
    <textarea id="source">

.front-page

# Infrastruktur som kode

## Presentasjon Software 2012

Ole Christian Rynning
&mdash;
<a href="http://twitter.com/olecr">@olecr</a>

Eivind Uggedal
&mdash;
<a href="http://twitter.com/uggedal">@uggedal</a>

7. februar 2012

---

.pushed.greyscale

![](images/hands.jpg)

.circle.red.top-right[Henda i været!]

.source[http://flic.kr/p/5Z9g8a]

---

.middle.center

# Jobber med drift?

---

.middle.center

# Hvor mange her er utviklere? (eller arkitekter)

---

.middle.center

# Begge deler? (devops)

---

.middle.center

# Deployer til skyen?

---

.middle.center

# Styrer (deler av?) egen infrastruktur?

---

.middle.center

# Har opplevd at systemer eller miljøer (infrastruktur) blir rotete eller avvikende?

---

.middle.center

# Har noen gang opplevd at en applikasjonen funker <strike>på min maskin</strike>. <strike>TEST</strike>. PROD?

---

# Kort om oss 

## Eivind Uggedal

Programmerer, har administrert og automatisert flere populære nettløsninger, samt sin egen MacBookPro/Air med Puppet. Jobber til daglig i stor norsk bank.

## Ole Christian Rynning

Programmerer med system- og infrastruktur-bakgrunn. Siste tre &aring;rene utviklet systemer, infrastruktur og plattform for kontinuerlige leveranser for Bring sitt utviklingsteam. 

---

# Agenda

* Infrastruktur som kode (Historisk blikk, Definisjon, Hvorfor?)
* Deklarativ konfigurasjonsstyring (Definisjon, Ulike alternativer, Orkestrering og Testing)
* En praktisk demonstrasjon 

---

# Historie

1. Manuell
2. Scripting
3. Fildistribuering
4. Deklarativ syntaks

![](images/timeline.png)

---

# Utviklerteknikker inn i drift 

* Versjonskontroll av konfigurasjon
* Refactoring og kontinuerlig forbedring (Inkrementell/evolusjoner arkitektur) 
* Test-drevet design

---

# (Noen) forretningsverdier

* Reproduserbar infrastruktur
* Større uavhengighet til eksisterende infrastruktur
	* Cloud, konkurranse, etc
* Enklere oversikt over miljøer
* A/B-testing av infrastruktur
* Evolusjonær arkitektur / infrastruktur
* På lengre sikt: lavere driftskostnader

---

# TODO: Og i tillegg... Utdyping av konfigurasjon som kode f&oslash;lger

* Kjørbar dokumentasjon
* Reproduserbarhet
* Mer homogenitet i miljøer
* Kontinuerlig integrasjon &amp; "ren kode" for drift
* Testing
* Refactoring

---

# Konfigurasjonsstyring

* Konfigurasjonsfiler
* Avhengigheter (innenfor en maskin og mellom maskiner og deres tjenester)
* Endringer i sanntid


---

.pushed.greyscale

![](images/cowboy.jpg)

# Mindre cowboy-virksomhet!

.source[http://flic.kr/p/6cdm8]

---

# TODO: Deklarativ Konfigurasjonsstyring

Definisjon fra f.eks. Luke Kanies / DCMP

---

.cols.two

# Deklarativ konfigurasjonsstyring

* Deklarativ fremfor imperativ
* Automatiserer og orkestrerer infrastruktur
* Gjenskape et milj&oslash; fra forskjellige utgangspunkt

<div class="col">
Imperativt for Debian:

    .bash
    apt-get install vim

    echo "set nocp" >> /etc/vim/vimrc

Imperativt for RedHat:

    .bash
    yum install vim

    echo "set nocp" >> /etc/vim/vimrc
</div>

<div class="col">
Deklarativt uavhengig av OS:

    .ruby
    package { "vim":
      ensure => present,
    }

    file { "/etc/vim/vimrc":
      content => "set nocp",
    }
</div>

---

# Historisk utvikling av konfigurasjonsstyring

<table>
  <tr>
    <th>
      &nbsp;
    <th>
      Utgitt
    <th>
      Spr&aring;k
  <tr>
    <td>
      Bourne shell
    <td>
      1977
    <td>
      Scripting
  <tr>
    <td>
      RCS
    <td>
      1982
    <td>
      Versjonskontrollsystem
  <tr>
    <td>
      Perl
    <td>
      1987
    <td>
      Krafull scripting
  <tr>
    <td>
      FreeBSD Ports
    <td>
      1993
    <td>
      Plattformuavhengig package manager
  <tr>
    <td>
      CFEngine
    <td>
      1993
    <td>
      Deklarativt DSL
  <tr>
    <td>
      Puppet
    <td>
      2005
    <td>
      H&oslash; deklarativt DSL
  <tr>
    <td>
      Chef
    <td>
      2009
    <td>
      Ruby
  <tr>
    <td>
      Salt
    <td>
      2011
    <td>
      YAML med Jinja templating
  <tr>
    <td>
      cdist
    <td>
      2011
    <td>
      POSIX Shell
</table>

---

# Sammenligninger av noen implementasjoner

<table>
  <tr>
    <th>
      &nbsp;
    <th>
      Puppet
    <th>
      Chef
    <th>
      Salt
    <th>
      Cdist
  <tr>
    <td>
      Klient/tjener
    <td class="has">
      &nbsp;
    <td class="has">
      &nbsp;
    <td class="has">
      &nbsp;
    <td class="has">
      &nbsp;
  <tr>
    <td>
      Pull
    <td class="has">
      &nbsp;
    <td class="has">
      &nbsp;
    <td>
      &nbsp;
    <td>
      &nbsp;
  <tr>
    <td>
      Push
    <td>
      &nbsp;
    <td>
      &nbsp;
    <td class="has">
      &nbsp;
    <td class="has">
      &nbsp;
  <tr>
    <td>
      Lokal modus
    <td class="has">
      &nbsp;
    <td class="has">
      &nbsp;
    <td>
      &nbsp;
    <td>
      &nbsp;
  <tr>
    <td>
      Impl. spr&aring;k
    <td>
      Ruby
    <td>
      Ruby
    <td>
      Python
    <td>
      Python/sh
  <tr>
    <td>
      Bruksspr&aring;k
    <td>
      DSL/Ruby
    <td>
      Ruby
    <td>
      YAML+Jinja/Python
    <td>
      sh
  <tr>
    <td>
      Avhengigheter klient
    <td>
      Ruby, Puppet, Facter
    <td>
      Ruby, Chef-client, Ohai
    <td>
      Python, Salt, &Oslash;MQ
    <td>
      ssh, sh
  <tr>
    <td>
      Avhengigheter tjener
    <td>
      Ruby, Puppetmaster, Rails, (database)
    <td>
      Ruby, Chef-server, Merb, Thin, Java, Solr, RabbitMQ
    <td>
      Python, Salt, &Oslash;MQ
    <td>
      Python, ssh, sh
  <tr>
    <td>
      Utbredelse
    <td>
      Stor
    <td>
      Stor
    <td>
      Liten
    <td>
      Nisje
</table>

---

# Native pakker

TODO: complete

Flytte kompleksitet fra konfigurasjonsstyringsverkt&oslash;y til
pakkesystemer (avhengighetsgraf,
enkel avinstallasjon og oppgradering, ...)

deb/rpm/ebuild/pkgsrc/pacman etc

FPM

---

# Testing av konfigurasjon

TODO: complete

---

# Slides og kode

<a href="https://github.com/bekkopen/infrastruktur-som-kode">
  github.com/bekkopen/infrastruktur-som-kode
</a>

---

.pushed.greyscale

![](images/question.jpg)

.circle.red.top-right[Sp&oslashrsm&aring;l?]

.source[http://flic.kr/p/ubG6g]














---

.front-page

# DEMO SLIDES FOLLOWS

---

.agenda

# Agenda

* Lære CoffeeScript
* Forstå JavaScript
* Komme igang med JQuery
* Se litt på Sass

---

# CoffeeScript

Prosjektet utførte et sett sentrale aktiviteter for å effektivisere organisasjonen:

* Kompilerer ned til JavaScript.Kompilerer ned til JavaScript.Kompilerer ned til JavaScript.Kompilerer ned til JavaScript.
* … men er ikke et supersett (som Sass er for CSS).
* Mindre kode enn JavaScript.
* "Ny funksjonalitet" på toppen av JavaScript.
* Unngår de dårlige sidene av JavaScript, f.eks. globale variabler.
* Inspirert av Python og Ruby (dere vil kjenne igjen mye!)
* Default i Rails 3.1

---

.round

# Tester rundt bilde

![](https://github.com/kjbekkelund/remark-bekk/raw/master/test/images/round/24.png)

---

.pushed

![](https://github.com/kjbekkelund/remark-bekk/raw/master/test/images/details/_DSC2394.jpg)

# Boks i hjørnet

.circle.red.top-right[Spørsmål?]

Nå kuttes iallefall bildet, og sirkelen kan settes forskjellige plasser.

---

.pushed

![Good times](https://github.com/kjbekkelund/remark-bekk/raw/master/test/images/details/_DSC2394.jpg)

# Boks i hjørnet

.circle.yellow.top-right[Gul?]

---

# JavaScript

* Det eneste programmeringsspråket som kjører i alle nettlesere.
* Brukes for å gjøre ting på klientsiden, f.eks. jobbe med DOM-en.
* Lang historie, men unngått av mange i flere år.
* Renessanse etter AJAX.
* Web 2.0
* Node.js

---

# Hva med highlighting av kode?

Vi bruker [Solarized](http://ethanschoonover.com/solarized), som ser ut til å passe godt med BEKK-themet.

Et Ruby-eksempel:

    .ruby
    names = people.map do |person|
      person.name.capitalize
    end

Og et JavaScript-eksempel:

    .javascript
    var names = []
    for (var i = 0, l = people.length; i &lt; l; i++) {
      var person = people[i];
      var name = person.name.slice(0,1).toUpperCase() +
                 person.name.slice(1);
      names.push(name);
    }

La oss gå gjennom noen av forskjellene.

---

# Litt mer seriøst

Det er lett å gjøre feil i JavaScript når man ikke kan språket skikkelig.

* Prototyper
* Globale variabler
* `==` vs `===`

Det er til og med en egen bok om hvordan bruke JavaScript rett.

---

.middle.center

# Intro til CoffeeScript

---

# CoffeeScript ≈ Ruby = ♥

Mye er likt Ruby, for eksempel:

* Ingen semikolon
* Trenger ikke paranteser for å kalle funksjoner
* Kommentarer starter med `#`
* Interpolasjon → `#{coffeescripting}`
* Implisitt `return`

Men CoffeeScript har noen særegenheter fra Ruby:

* Signifikant whitespace
* Ikke-blokkerende IO (Mindre skummelt enn det høres ut)

---

# Variabler

    .coffee
    myVariable = "test"
    someNumber = 42
    aBoolean = true

Helt likt Ruby — men camelcased.

---

# unless

Vi har unless også i CoffeeScript:

    .coffee
    alert "bu!" unless person.name == "Kim Joar"

# ?

Er en operator i CoffeeScript, ikke en del av funksjonsnavnet som i Ruby.

    .coffee
    practice() unless good_enough?

    c ?= d # er det samme som c = d unless c?

---

# Komme igang med JavaScript

* [Understanding “Prototypes” in JavaScript](http://yehudakatz.com/2011/08/12/understanding-prototypes-in-javascript/)
* [Understanding JavaScript Function Invocation and "this"](http://yehudakatz.com/2011/08/11/understanding-javascript-function-invocation-and-this/)
* [JavaScript: The World's Most Misunderstood Programming Language](http://www.crockford.com/javascript/javascript.html)
* [What should every JavaScript programmer know?](http://stackoverflow.com/questions/2628672/what-should-every-javascript-programmer-know)

---

.cols.three

# Tester 3 kolonner

<div class="col">
  .circle.red.centered[Kolonne 1]

  *em* sweet

  [kimjoar.net](http://kimjoar.net)
</div>

<div class="col">
  .circle.red.centered[Kolonne 2]

  * liste!
  * nytt element
  * #winning
</div>

<div class="col">
  .circle.yellow.centered[Kolonne 3]

  # overskrift

  (vi ser altså at alt ikke fungerer i kolonner enda, blant annet overskrifter)
</div>

---

.cols.two

# Tester 2 kolonner

<div class="col">
  Første kolonne
</div>

<div class="col center">
  Andre kolonne

  (med sentrert tekst)
</div>

---

.middle.center

# Spørsmål?

Presentasjonen er laget med [remark](http://gnab.github.com/remark/).

    </textarea>
    <div id="slideshow"></div>
  </body>
</html>
